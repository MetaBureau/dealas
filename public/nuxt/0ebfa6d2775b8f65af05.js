(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{333:function(t,e,n){},339:function(t,e,n){"use strict";n(47);var r,o=n(11),c=n(58),l=n(81),d=n(39),m={computed:{currentUser:function(){return this.$store.getters["auth/getUser"]}},methods:{addVote:(r=Object(o.a)(regeneratorRuntime.mark((function t(e,n){var r,o,l,m,v,f,h,_,C;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentUser.loggedIn){t.next=3;break}return this.$router.push("/prisijungti"),t.abrupt("return");case 3:return r=e,o=this.currentUser.data.email,l="".concat(r,"_").concat(o),t.next=8,d.b.collection("votes").doc(l);case 8:return m=t.sent,t.next=11,m.get();case 11:return v=t.sent,t.next=14,d.b.collection("deals").doc(e);case 14:return f=t.sent,t.next=17,f.get();case 17:h=t.sent,_=h.data(),C=0,void 0!==_.score&&(C=_.score),v.exists?(v.data().type!==n&&(m.update({type:n}),C+="upvote"===n?2:-2,f.update({score:C})),this.setScore(r,C)):(m.set({userId:o,dealId:r,type:n}),C+="upvote"===n?1:-1,f.update({votes:c.firestore.FieldValue.arrayUnion(m.id),score:C}),this.setScore(r,C));case 22:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)}),setScore:function(t,e){Object(l.get)(this.$store.state.deals,"deal")?this.$store.dispatch("deals/UPDATE_SCORE",e):this.$store.dispatch("deals/UPDATE_DEAL_SCORE",{dealId:t,score:e})}}},v=n(69),component=Object(v.a)(m,void 0,void 0,!1,null,null,null);e.a=component.exports},372:function(t,e,n){"use strict";var r=n(333);n.n(r).a},397:function(t,e,n){"use strict";n.r(e);n(13),n(8),n(7),n(5),n(9);var r=n(2),o=(n(47),n(11)),c=n(128),l=n(58),d=n(81),m={name:"DisplayDateComponent",props:{date:{type:Object,default:null}},computed:{localeDate:function(){return this.date?this.date.toDate().toUTCString():null}}},v=n(69);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var h,_={components:{DisplayDateComponent:Object(v.a)(m,(function(){var t=this.$createElement;return(this._self._c||t)("span",[this._v("\n  "+this._s(this.localeDate)+"\n")])}),[],!1,null,null,null).exports},mixins:[n(339).a],asyncData:(h=Object(o.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.params.id,t.next=3,e.store.dispatch("deals/VIEW_DEAL",n);case 3:return t.abrupt("return",{dealId:n});case 4:case"end":return t.stop()}}),t)}))),function(t){return h.apply(this,arguments)}),data:function(){return{commentContent:null}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(c.b)("auth",{user:"getUser"}),{},Object(c.b)("deals",{deal:"getDeal",comments:"getComments"})),mounted:function(){this.$store.dispatch("deals/INITIATE_LISTENING_TO_COMMENTS",this.dealId)},beforeDestroy:function(){this.$store.dispatch("deals/LEAVE_DEAL")},methods:{postComment:function(){var t=Object(d.get)(this.user.data,"displayName"),e={dealId:this.dealId,userId:this.user.data.uid,content:this.commentContent,timestamp:l.firestore.FieldValue.serverTimestamp(),userName:Object(d.isNil)(t)?"Not disclosed":t};this.$store.dispatch("deals/POST_COMMENT",e)}},head:function(){return{title:"Dealas - ".concat(this.deal.title),meta:[{hid:"description",name:"description",content:"".concat(this.deal.description)}]}}},C=(n(372),n(96)),O=n.n(C),y=n(160),w=n(340),x=n(321),j=n(386),D=n(146),E=n(389),k=n(338),I=Object(v.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",{staticClass:"pt-5"},[n("v-col",{attrs:{"offset-sm":"2",cols:"12",sm:"8"}},[n("v-card",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"7"}},[t.deal?n("div",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",{staticClass:"subtitle-2"},[t._v("\n                  "+t._s(t.deal.title)+"\n                ")])]),t._v(" "),n("v-card-text",{staticClass:"d-flex flex-column flex-grow-1"},[n("div",{staticClass:"caption"},[t._v("\n                  "+t._s(t.deal.description)+"\n                ")]),t._v(" "),n("div",{staticClass:"flex-grow-1"},[n("img",{attrs:{src:t.deal.image,width:"100%",height:"100%"}})])]),t._v(" "),n("v-card-actions",{staticClass:"text-center justify-center overline font-weight-thin grey--text"},[null!==t.deal.endsAt?n("div",{},[t._v("\n                  Galioja iki "+t._s(t.deal.endsAt)+"\n                ")]):t._e()])],1):t._e()]),t._v(" "),t.deal?n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"5"}},[n("div",[n("v-btn",{attrs:{color:"primary",target:"_blank",href:t.deal.link}},[t._v("Atidaryti nuoroda")])],1),t._v(" "),n("div",{staticClass:"pt-5"},[n("div",[t._v(t._s(t.deal.distributor))]),t._v(" "),n("div",[n("span",{staticClass:"caption"},[t._v(" €"+t._s(t.deal.oldPrice)+" ")]),t._v(" "),n("span",{staticClass:"title green--text font-weight-bold"},[t._v("\n                  €"+t._s(t.deal.newPrice)+"\n                ")])])]),t._v(" "),n("div",{staticClass:"pt-1"},[n("span",{staticClass:"font-weight-medium pl-1 pr-1"},[n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addVote(t.deal.id,"downvote")}}},[n("v-icon",{attrs:{color:"blue"}},[t._v("mdi-minus")])],1)],1),t._v("\n              "+t._s(t.deal.score)+"\n              "),n("span",{staticClass:"font-weight-medium pl-1 pr-1"},[n("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addVote(t.deal.id,"upvote")}}},[n("v-icon",{attrs:{color:"red"}},[t._v("mdi-plus")])],1)],1)]),t._v(" "),n("div",[n("a",{staticClass:"comment-link",attrs:{href:"#comments"}},[n("v-icon",[t._v("mdi-comment")]),t._v(" komentarai\n              ")],1)])]):t._e()],1)],1)],1)],1),t._v(" "),n("v-row",{attrs:{id:"comments"}},[n("v-col",{attrs:{"offset-sm":"2",cols:"12",sm:"8"}},[n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[t._v("\n          Komentarai\n        ")]),t._v(" "),n("v-card-text",[n("div",{staticClass:"comments"},[n("div",[n("v-text-field",{attrs:{name:"comments",label:"Jūsų komentaras","clear-icon":"mdi-close-circle",type:"text",clearable:"","append-outer-icon":"mdi-send"},on:{"click:append-outer":t.postComment},model:{value:t.commentContent,callback:function(e){t.commentContent=e},expression:"commentContent"}})],1),t._v(" "),n("div",t._l(t.comments,(function(e){return n("div",{key:e.id,staticClass:"comment-container pa-3 mt-3 mb-3"},[n("div",{staticClass:"caption"},[n("span",{staticClass:"font-weight-bold"},[t._v("\n                    "+t._s(e.userName?e.userName:"user")+"\n                  ")]),t._v(" "),n("DisplayDateComponent",{attrs:{date:e.timestamp}})],1),t._v(" "),n("div",{staticClass:"commentContent"},[t._v("\n                  "+t._s(e.content)+"\n                ")])])})),0)])])],1)],1),t._v(" "),n("v-col",{attrs:{offset:"2"}})],1)],1)}),[],!1,null,"74b882e8",null);e.default=I.exports;O()(I,{VBtn:y.a,VCard:w.a,VCardActions:x.a,VCardText:x.b,VCardTitle:x.c,VCol:j.a,VIcon:D.a,VRow:E.a,VTextField:k.a})}}]);